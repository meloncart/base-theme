<div class="row">
    <div class="col-md-5">
        <div class="position-relative">
            {% if product.on_sale %}
                <div class="position-absolute top-0 start-0" style="z-index:1000">
                    <span class="badge bg-danger fs-6">On Sale!</span>
                </div>
            {% endif %}
            {% partial 'shop-product/product-images' %}
        </div>
    </div>

    <div class="col-md-7">
        <div class="ps-5 mt-4">
            {% if product.primaryCategory %}
                <p class="mb-3">
                    <a href="{{ product.primaryCategory.pageUrl('shop/category') }}" class="d-block">
                        {{ product.primaryCategory.name }}
                    </a>
                </p>
            {% endif %}

            <h1 class="mb-1">
                {{ product.title ? product.title : product.name }}
            </h1>

            <div class="fs-4">
                {% if product.use_variants %}
                    {% set postedOptions = post('product_options', {}) %}
                    {% set variant = product.resolveVariantSafe(postedOptions) %}
                    {% if variant %}
                        <span class="fw-bold text-dark">{{ variant.getCompiledPrice(1)|currency }}</span>
                        {% if variant.is_on_sale %}
                            <span class="text-decoration-line-through text-muted">{{ variant.price|currency }}</span>
                        {% endif %}
                    {% else %}
                        <span class="fw-bold text-dark">{{ product.final_sale_price|currency }}</span>
                    {% endif %}
                {% else %}
                    <span class="fw-bold text-dark">{{ product.final_sale_price|currency }}</span>
                    {% if product.on_sale %}
                        <span class="text-decoration-line-through text-muted">{{ product.final_price|currency }}</span>
                    {% endif %}
                {% endif %}
            </div>

            <form>
                <input type="hidden" name="product_baseid" value="{{ product.baseid }}" />

                <div class="product-options mb-3">
                    {% partial 'shop-product/product-options' %}
                </div>
                <div class="product-extra-options mb-3">
                    {% partial 'shop-product/product-extra-options' %}
                </div>

                {% if product.bundle_items is not empty %}
                    <div id="productBundleItems" class="product-bundle-items mb-3">
                        {% partial 'shop-product/bundle' %}
                    </div>
                {% endif %}

                {% if product.use_variants %}
                    {% set postedOptions = post('product_options', {}) %}
                    {% set variant = product.resolveVariantSafe(postedOptions) %}
                    {% if variant and not variant.is_enabled %}
                        <div class="alert alert-warning">
                            This product combination is currently unavailable.
                        </div>
                    {% elseif variant and variant.isOutOfStock() and not product.allow_pre_order %}
                        <div class="alert alert-danger">
                            This product is temporarily out of stock.
                            {% if variant.available_at %}
                                Expected availability: <strong>{{ variant.available_at|date('M d, Y') }}</strong>
                            {% endif %}
                        </div>
                    {% elseif not variant and postedOptions is not empty %}
                        <div class="alert alert-warning">
                            This product combination is not available.
                        </div>
                    {% else %}
                        <div class="product-panel">
                            {% partial 'shop-product/add-to-cart-control' %}
                        </div>
                    {% endif %}
                {% else %}
                    <div class="product-panel">
                        {% partial 'shop-product/add-to-cart-control' %}
                    </div>
                {% endif %}
            </form>
        </div>
    </div>
</div>

{% set hasInfo = product.properties is not empty or product.weight or product.height or product.width or product.depth or product.visible_price_tiers is not empty %}

<div>
    <ul class="nav nav-pills nav-line-pills" id="productTabs">
        <li class="nav-item">
            <button class="nav-link active" id="detailsTab" data-bs-toggle="tab" data-bs-target="#detailsTabPane" type="button">
                Product Description
            </button>
        </li>
        {% if hasInfo %}
            <li class="nav-item">
                <button class="nav-link" id="infoTab" data-bs-toggle="tab" data-bs-target="#infoTabPane" type="button">
                    Information
                </button>
            </li>
        {% endif %}
        <li class="nav-item">
            <button class="nav-link" id="reviewsTab" data-bs-toggle="tab" data-bs-target="#reviewsTabPane" type="button">
                Reviews
                {% if reviews.reviewsCount > 0 %}
                    <span class="badge bg-primary ms-1">
                        {{ reviews.reviewsCount }}
                    </span>
                {% endif %}
            </button>
        </li>
    </ul>
    <div class="tab-content" id="productTabsContent">
        <div class="tab-pane fade show active" id="detailsTabPane" tabindex="0">
            <div class="my-4">
                {% if product.short_description or product.description %}
                    <p class="lead">{{ product.short_description }}</p>
                    {{ product.description|raw }}
                {% else %}
                    <p class="text-muted"><em>Product has no description.</em></p>
                {% endif %}
            </div>
        </div>
        {% if hasInfo %}
            <div class="tab-pane fade" id="infoTabPane" tabindex="0">
                {% partial 'shop-product/product-attributes' %}
                {% partial 'shop-product/product-price-tiers' %}
            </div>
        {% endif %}
        <div class="tab-pane fade" id="reviewsTabPane" tabindex="0">
            <div class="py-8">
                {% partial 'shop-product/product-reviews' %}
            </div>
        </div>
    </div>
</div>
